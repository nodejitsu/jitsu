#!/usr/bin/env node

var jitsu = require('../lib/jitsu');

require('completed').setup({
  program: 'jitsu',
  completion: '../lib/jitsu/completion'
});

jitsu.start(function (err) {
  if (!err) {
    jitsu.log.info('Nodejitsu'.grey + ' ok'.green.bold);
  }

  process.stdout.on('drain', function () {
    process.exit(err ? 1 : 0);
  })

  function onexit (code, status) {
    if (err) {
      process.removeListener('exit', onexit);
      process.exit(1);
    }
  }

  process.on('exit', onexit);
});
